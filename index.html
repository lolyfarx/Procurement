<!DOCTYPE html>
<html dir="rtl" lang="ar" id="mainHtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YN-ERP | شركة النهدي التجارية</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <div id="splash-screen">
        <div class="splash-content">
            <div class="logo-box">YN</div>
            <h2 class="company-name">شركة ياسر يسلم النهدي التجارية</h2>
            <div class="loader-bar"><div></div></div>
            <p class="dev-tag">نظام المشتريات المطور 2026</p>
        </div>
    </div>

    <div id="app-container" style="display: none;">
        <header class="odoo-top-nav">
            <div class="nav-left">
                <i class="bi bi-list mobile-menu-btn" onclick="toggleSidebar()"></i>
                <span class="app-title">YN-ERP</span>
            </div>
            <div class="nav-right d-flex align-items-center">
                <span id="display-user-name" class="me-2 fw-bold">Admin</span>
                <div class="user-avatar">Y</div>
            </div>
        </header>

        <div class="main-layout">
            <aside class="odoo-sidebar" id="sidebar">
                <div class="menu-section">القائمة الرئيسية</div>
                <a href="#" class="nav-item active" onclick="showSection('dashboard')"><i class="bi bi-speedometer2"></i> لوحة التحكم</a>
                <a href="#" class="nav-item" onclick="showSection('new-request')"><i class="bi bi-cart-plus"></i> طلب شراء جديد</a>
                <div class="menu-section">النظام</div>
                <a href="#" class="nav-item" onclick="showSection('settings')"><i class="bi bi-gear"></i> الإعدادات</a>
            </aside>

            <main class="content-area p-3">
                <div id="section-dashboard">
                    <div class="row g-3 mb-4">
                        <div class="col-6 col-md-3"><div class="stat-card blue"><h6>إجمالي المشتريات</h6><p class="num">1.2M</p></div></div>
                        <div class="col-6 col-md-3"><div class="stat-card orange"><h6>طلبات اليوم</h6><p class="num">8</p></div></div>
                    </div>
                    <div class="card p-3 border-0 shadow-sm">
                        <canvas id="mainChart" height="120"></canvas>
                    </div>
                </div>

                <div id="section-new-request" style="display:none;">
                    <div class="card p-3 shadow-sm border-0">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="fw-bold mb-0">إنشاء طلب شراء</h5>
                            <div class="btn-group">
                                <button class="btn btn-outline-success btn-sm" onclick="document.getElementById('fileInput').click()"><i class="bi bi-file-earmark-excel"></i> استيراد</button>
                                <button class="btn btn-outline-primary btn-sm" onclick="exportToExcel()"><i class="bi bi-download"></i> تصدير</button>
                                <input type="file" id="fileInput" hidden onchange="importExcel(event)">
                            </div>
                        </div>
                        <div class="row g-2 mb-3">
                            <div class="col-md-4"><label class="small fw-bold">الفرع / القسم</label><select id="req-dept" class="form-select"></select></div>
                            <div class="col-md-4"><label class="small fw-bold">المسؤول عن الطلب</label><input type="text" id="resp-user" class="form-control" readonly></div>
                            <div class="col-md-4"><label class="small fw-bold">التاريخ والوقت</label><input type="text" id="curr-date" class="form-control bg-light" readonly></div>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-bordered align-middle">
                                <thead class="bg-light">
                                    <tr class="small text-center">
                                        <th>البراند</th>
                                        <th>المقاس (العرض/الارتفاع/القطر)</th>
                                        <th>الكمية</th>
                                        <th class="price-col">التكلفة</th>
                                        <th>-</th>
                                    </tr>
                                </thead>
                                <tbody id="items-table"></tbody>
                            </table>
                        </div>
                        <button class="btn btn-sm btn-outline-secondary mb-3" onclick="addNewRow()">+ إضافة صنف</button>
                        <div class="price-col text-end mb-3">
                            <h6 class="fw-bold">إجمالي الطلب: <span id="grand-total">0</span> ر.س</h6>
                        </div>
                        <button class="btn btn-odoo-primary w-100 p-3 fw-bold" onclick="submitFinal()">إرسال الطلب للاعتماد</button>
                    </div>
                </div>

                <div id="section-settings" style="display:none;">
                    <div class="card p-3 shadow-sm border-0">
                        <h5 class="fw-bold mb-3 border-bottom pb-2">إعدادات المستخدم والصلاحيات</h5>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label>اسم المستخدم</label><input type="text" id="set-u" class="form-control mb-2" placeholder="Admin">
                                <label>كلمة المرور</label><input type="password" id="set-p" class="form-control mb-2" placeholder="****">
                                <div class="form-check form-switch mb-3"><input class="form-check-input" type="checkbox" id="set-show-price" checked><label class="form-check-label">إظهار التكلفة والإجماليات</label></div>
                                <button class="btn btn-primary w-100" onclick="saveSettings()">حفظ التغييرات</button>
                            </div>
                            <div class="col-md-6 border-start">
                                <div class="p-3 bg-light rounded text-center">
                                    <h6>تفاصيل النظام</h6>
                                    <p class="small text-muted mb-1">الإصدار: v2026.1.5</p>
                                    <p class="small text-muted mb-1">المطور: Gemini ERP Expert</p>
                                    <p class="small text-muted">شركة ياسر يسلم النهدي التجارية</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>